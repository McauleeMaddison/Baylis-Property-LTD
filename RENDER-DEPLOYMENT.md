# Render Deployment Guide

Render gives you the same “connect repo → auto deploy” workflow as Railway, plus a generous free tier (750 instance hours/month) that is perfect for this app. Follow the steps below to move the existing Baylis Property stack (Node + MySQL + migrations) onto Render.

---

## 1. Create an Account & Link GitHub

1. Visit **https://render.com** and create an account (GitHub login keeps things in sync).
2. Click **New +** → **Web Service** → **Build and deploy from a Git repository**.
3. Install/authorize the Render GitHub app, then pick the `Baylis-Property-LTD` repository.

> Every push to `main` (or whichever branch you select) will now trigger a new deployment automatically.

---

## 2. Configure the Web Service

When Render asks for build settings, use the following values:

| Setting | Value |
| --- | --- |
| **Environment** | `Node` |
| **Branch** | `main` (or whichever you deploy from) |
| **Root Directory** | `/` (leave blank) |
| **Build Command** | `npm install && cd server && npm install` |
| **Start Command** | `cd server && npm start` |
| **Instance Type** | `Starter` (free tier) |

Why two installs? The repository has a top-level `package.json` plus another in `server/`. Running both ensures the correct dependencies exist before Render tries to boot the API server.

After saving, Render spins up the service and will fail at first because the database variables are not set. We’ll fix that next.

---

## 3. Add a MySQL Database on Render

1. In the Render dashboard, click **New +** → **MySQL**.
2. Name it something like `baylis-db` and choose the free tier.
3. Wait for the DB to finish provisioning (Status → `Available`).

Render exposes the credentials under the database’s **Connections** tab. You’ll use these to populate the API service’s environment variables.

If you already have an external MySQL (PlanetScale, Railway, etc.), you can skip creating a new one and reuse the existing credentials—just paste them in the next step.

---

## 4. Set Environment Variables

Open the **Environment** tab on your web service and add the following key/value pairs. For each `MYSQL_*` field, copy the values from the Render MySQL service (or link them using “Add from Service” if your account has that option).

```
NODE_ENV = production
PORT = 5000
HOST = 0.0.0.0
MYSQL_HOST = <Render MySQL host>
MYSQL_USER = <Render MySQL user>
MYSQL_PASSWORD = <Render MySQL password>
MYSQL_DATABASE = <Render MySQL database name>
```

> The server reads exactly these variable names (`server/mysql.js`), so keep the names identical.

Click **Save Changes**. Render restarts the service and the app should now boot successfully once the database is reachable.

---

## 5. Run Database Migrations

Your MySQL instance starts empty. To create the tables:

1. Open the web service → **Shell** (or use `render login` with the CLI and run `render shell`).
2. Run the migration command from the repository root:
   ```bash
   cd /opt/render/project/src/server
   npm run migrate
   ```
3. You should see `✅ Migrations completed successfully` when it finishes.

Re-run this command any time you change the SQL files in `migrations/`.

---

## 6. Verify the Deployment

1. View **Logs** on the web service; you want to see `Server running on port 5000` with no MySQL errors.
2. Click the autogenerated Render URL (e.g., `https://baylis-property.onrender.com`) to make sure the site loads.
3. Test any authenticated routes/forms to ensure they can read/write from the new database.

---

## 7. Add a Custom Domain (Optional)

1. In the web service → **Custom Domains** → **Add Custom Domain**.
2. Enter `baylisproperty.co.uk` (or another domain).
3. Render shows the DNS records (usually a CNAME) you need to add at your registrar (GoDaddy/Namecheap/etc.).
4. Wait for DNS propagation (can take a few hours) and verify in the Render dashboard once it turns green.

If you previously configured Google Search Console, update the property to point to the new Render-hosted URL if necessary and resubmit the sitemap (`https://your-domain.com/sitemap.xml`).

---

## 8. Optional Extras

- **Cron/Background jobs**: Use Render **Cron Jobs** or **Background Workers** if you need scheduled tasks (e.g., nightly emails). Point them at scripts in `server/scripts/`.
- **Secrets management**: Store any API keys (Google Sheets, etc.) alongside the other environment variables. Render keeps them encrypted at rest.
- **Scaling**: If you hit the free tier limits, switch the Instance Type to a paid plan or enable autoscaling in the service settings.
- **Monitoring**: Enable health checks (`/` route or `/status`) and plug into Slack/Discord notifications from Render’s settings for quicker alerts.

---

That’s it—you now have the entire Baylis Property application running on Render with automated deploys, managed MySQL, environment variables, and migrations. Push to GitHub whenever you need to redeploy; Render takes care of the rest.

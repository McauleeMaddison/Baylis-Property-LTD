<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Settings for Baylis Property LTD — appearance, notifications, privacy." />
  <title>Settings • Baylis Property LTD</title>

  <link rel="icon" href="assets/logo.svg" />
  <link rel="stylesheet" href="css/style.css" />
  <script src="js/api-base.js"></script>
  <script defer src="js/script.js"></script>
  <script defer src="js/settings.js"></script>
  <link rel="prefetch" href="index.html" />
  <link rel="prefetch" href="profile.html" />

  <style>
    .settings-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-4); margin-top: var(--space-4); }
    .chip-row { display:flex; gap:.5rem; flex-wrap:wrap; margin: .75rem 0 1rem; }
    .chip-row .btn-chip { border:1px solid var(--border); border-radius: var(--radius-full); padding:.4rem .75rem; background:transparent; }
    .twofa-panel { margin-top:1rem; border:1px solid var(--border); border-radius: var(--radius); padding: var(--space-4); background: var(--bg-light); box-shadow: var(--shadow); }
    .twofa-actions { display:flex; gap:.5rem; flex-wrap:wrap; }
    .twofa-flow { margin-top:1rem; border:1px dashed var(--accent-soft-bd); border-radius: var(--radius-2xs); padding: var(--space-3); background: var(--bg); }
    .twofa-flow-actions { display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.6rem; }
    .text-small { font-size: var(--fs-14); }
  </style>
</head>
<body class="page page--settings" data-required-role="resident,landlord" data-api-base="/api">
  <a class="skip-link" href="#content">Skip to main content</a>
  <header class="site-header" id="mainHeader">
    <nav class="nav" aria-label="Main">
      <div class="nav-inner container">
        <a class="logo" href="index.html" aria-label="Baylis Property LTD Home">
          <img src="assets/logo.svg" alt="" width="32" height="32" />
          <span>Baylis Property LTD</span>
        </a>

        <button class="btn secondary hamb" aria-expanded="false" aria-controls="navLinks" aria-label="Toggle menu" data-hamb>☰</button>

        <div class="nav-links" id="navLinks" data-links data-open="false">
          <!-- Dashboard link removed (login required) -->
          <a href="resident.html">Resident</a>
          <a href="landlord.html">Landlord</a>
          <a href="community.html">Community</a>
          <a href="profile.html">Profile</a>
          <a href="settings.html" aria-current="page">Settings</a>
          <a href="login.html">Login</a>
          <a href="register.html">Register</a>
        </div>
      </div>
    </nav>
  </header>

  <main role="main" id="content" class="container" tabindex="-1" style="margin-top:1rem;">
    <header class="header">
      <h1 class="h1">Settings</h1>
      <p class="muted">Tune your experience. Changes to appearance are previewed live.</p>
    </header>

    <div class="chip-row">
      <a class="btn-chip" href="#general">General</a>
      <a class="btn-chip" href="#appearance">Appearance</a>
      <a class="btn-chip" href="#notifications">Notifications</a>
      <a class="btn-chip" href="#security">Security &amp; Privacy</a>
    </div>

    <section class="dashboard-card" id="previewCard">
      <p class="muted">Buttons and surfaces reflect your appearance choices below.</p>
      <div style="display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.4rem;">
        <button class="btn" id="previewBtnPrimary">Primary</button>
        <button class="btn btn-ghost" id="previewBtnGhost">Ghost</button>
      </div>
    </section>

    <form id="settingsForm">
      <div class="settings-grid">
        <section id="general" class="dashboard-card">
          <h2 class="h3">General</h2>
          <p class="muted">Basic preferences for your account on this device.</p>

          <label class="checkbox" style="margin-top:.75rem;">
            <input type="checkbox" id="showTips" />
            <span>Show onboarding tips</span>
          </label>

          <label class="field" for="defaultLanding" style="margin-top:.6rem;">
            <span>Default landing page</span>
            <select id="defaultLanding" aria-describedby="settingsMsg">
              <option value="resident.html">Resident Dashboard</option>
              <option value="landlord.html">Landlord Dashboard</option>
              <option value="profile.html">Profile</option>
              <option value="settings.html" selected>Settings</option>
            </select>
            <small class="muted">Used after you sign in.</small>
          </label>

          <label class="field" for="timeFormat" style="margin-top:.6rem;">
            <span>Time format</span>
            <select id="timeFormat" aria-describedby="settingsMsg">
              <option value="24h" selected>24-hour</option>
              <option value="12h">12-hour (AM/PM)</option>
            </select>
          </label>
        </section>

        <section id="appearance" class="dashboard-card">
          <h2 class="h3">Appearance</h2>
          <p class="muted">Color, density, and theme preferences.</p>

          <label class="checkbox" style="margin-top:.75rem;">
            <input type="checkbox" id="darkModeSetting" aria-describedby="settingsMsg" />
            <span>Enable dark mode by default</span>
          </label>

          <label class="field" for="accentColor" style="margin-top:.6rem;">
            <span>Accent color</span>
            <input type="color" id="accentColor" value="#4a90e2" aria-describedby="settingsMsg" />
            <small class="muted">Affects highlights and focus states.</small>
          </label>

          <label class="field" for="uiDensity" style="margin-top:.6rem;">
            <span>UI density</span>
            <select id="uiDensity" aria-describedby="settingsMsg">
              <option value="comfortable" selected>Comfortable</option>
              <option value="compact">Compact</option>
              <option value="spacious">Spacious</option>
            </select>
          </label>

          <label class="field" for="baseFontSize" style="margin-top:.6rem;">
            <span>Base font size (px)</span>
            <input type="number" id="baseFontSize" value="16" min="12" max="22" aria-describedby="settingsMsg" />
          </label>

          <label class="field" for="cornerRadius" style="margin-top:.6rem;">
            <span>Corner radius (px)</span>
            <input type="number" id="cornerRadius" value="12" min="6" max="24" aria-describedby="settingsMsg" />
          </label>
        </section>

        <section id="notifications" class="dashboard-card">
          <h2 class="h3">Notifications</h2>
          <p class="muted">Choose what we should ping you about.</p>

          <div style="display:grid; gap:.55rem; margin-top:.75rem;">
            <label class="checkbox"><input type="checkbox" id="notifRequests" aria-describedby="settingsMsg" /> <span>Requests</span></label>
            <label class="checkbox"><input type="checkbox" id="notifCommunity" aria-describedby="settingsMsg" /> <span>Community posts</span></label>
            <label class="checkbox"><input type="checkbox" id="notifDigest" aria-describedby="settingsMsg" /> <span>Weekly digest</span></label>
          </div>

          <label class="field" for="digestDay" style="margin-top:.6rem;">
            <span>Digest day</span>
            <select id="digestDay" aria-describedby="settingsMsg">
              <option>Monday</option>
              <option>Tuesday</option>
              <option>Wednesday</option>
              <option>Thursday</option>
              <option>Friday</option>
              <option>Saturday</option>
              <option>Sunday</option>
            </select>
          </label>
        </section>

        <section id="security" class="dashboard-card">
          <h2 class="h3">Security &amp; Privacy</h2>
          <p class="muted">Passwords, devices, and your data.</p>

          <div class="twofa-panel" aria-live="polite">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:.75rem; flex-wrap:wrap;">
              <div>
                <p class="muted">Two-factor authentication</p>
                <p id="twoFaStatusText" class="h4" style="margin:0;">Checking…</p>
              </div>
              <div class="twofa-actions">
                <button type="button" class="btn" id="twoFaEnableBtn">Enable 2FA</button>
                <button type="button" class="btn btn-ghost" id="twoFaDisableBtn">Disable 2FA</button>
              </div>
            </div>
            <p class="muted text-small" id="twoFaMeta">Add a verification code after your password to keep intruders out.</p>
            <div id="twoFaFlow" class="hidden twofa-flow" aria-live="assertive">
              <label class="field" for="twoFaCode">
                <span>Verification code</span>
                <input id="twoFaCode" type="text" inputmode="numeric" maxlength="6" placeholder="000000" autocomplete="one-time-code" />
              </label>
              <div class="twofa-flow-actions">
                <button type="button" class="btn" id="twoFaVerifyBtn">Verify</button>
                <button type="button" class="btn btn-ghost" id="twoFaResendBtn">Resend code</button>
                <button type="button" class="btn secondary" id="twoFaCancelBtn">Cancel</button>
              </div>
              <p class="muted text-small" id="twoFaCountdown"></p>
            </div>
          </div>

          <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:.6rem; margin-top:.75rem;">
            <label class="field" for="currentPassword">
              <span>Current password</span>
              <input id="currentPassword" type="password" autocomplete="current-password" aria-describedby="settingsMsg" />
            </label>
            <label class="field" for="newPassword">
              <span>New password</span>
              <input id="newPassword" type="password" autocomplete="new-password" aria-describedby="settingsMsg" />
            </label>
            <label class="field" for="confirmNewPassword">
              <span>Confirm new password</span>
              <input id="confirmNewPassword" type="password" autocomplete="new-password" aria-describedby="settingsMsg" />
            </label>
          </div>

          <div style="display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.6rem;">
            <button type="button" class="btn" id="changePasswordBtn">Change password</button>
            <button type="button" class="btn btn-ghost" id="signOutAllBtn">Sign out of all devices</button>
          </div>

          <div style="display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.6rem;">
            <button type="button" class="btn secondary" id="exportDataBtn">Export my data</button>
            <button type="button" class="btn secondary" id="clearLocalBtn">Clear local data</button>
            <button type="button" class="btn btn-ghost" id="resetDefaults">Reset defaults</button>
          </div>
        </section>
      </div>

      <div style="display:flex; justify-content:flex-end; margin-top:1rem;">
        <button type="submit" class="btn">Save settings</button>
      </div>
      <div id="settingsMsg" class="form-msg" role="alert" aria-live="assertive" tabindex="-1"></div>
    </form>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>&copy; <span id="year"></span> Baylis Property LTD</small>
      <span class="dot">&middot;</span>
      <a href="community.html">Community</a>
      <span class="dot">&middot;</span>
      <a href="settings.html" aria-current="page">Settings</a>
    </div>
  </footer>

  <script>
    (function() {
      const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
      const hamb = document.querySelector('[data-hamb]');
      const links = document.querySelector('[data-links]');
      if (hamb && links) {
        const setOpen = (open) => {
          hamb.setAttribute('aria-expanded', String(open));
          links.dataset.open = String(open);
          document.body.classList.toggle('nav-open', open);
        };
        hamb.addEventListener('click', () => setOpen(links.dataset.open !== 'true'));
        links.addEventListener('click', e => { if (e.target.closest('a')) setOpen(false); });
        document.addEventListener('keydown', e => { if (e.key === 'Escape') setOpen(false); });
        document.addEventListener('click', e => { if (!links.contains(e.target) && !hamb.contains(e.target)) setOpen(false); });
      }
    })();
  </script>
  <style>
    .btn { --_accent: var(--accent, #4a90e2); }
    .density-compact .dashboard-card { padding: .6rem; }
    .density-comfortable .dashboard-card { padding: 1rem; }
    .density-spacious .dashboard-card { padding: 1.4rem; }
  </style>
</body>
</html>

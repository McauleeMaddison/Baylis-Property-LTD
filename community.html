<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Community hub for Baylis Property LTD residents and landlords: post updates, ask questions, and connect." />
  <title>Community • Baylis Property LTD</title>
  <link rel="icon" href="assets/logo.png" />
  <link rel="stylesheet" href="css/style.css" />
  <script>window.API_BASE = window.API_BASE || 'http://localhost:4000/api';</script>
  <script defer src="js/script.js"></script>
  <script defer src="js/community.js"></script>
  <style>
    .community-hero{display:flex;align-items:center;justify-content:space-between;gap:.8rem;flex-wrap:wrap}
    .hero-actions{display:flex;gap:.4rem;align-items:center;flex-wrap:wrap}
    .filters-row{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}
    .filters-row .checkbox{display:flex;gap:.35rem;align-items:center}
    .composer{display:grid;gap:.6rem}
    .composer .grid-2{display:grid;grid-template-columns:1fr;gap:.6rem}
    .post-feed{list-style:none;padding:0;margin:0;display:grid;gap:.6rem}
    .post{border:1px solid var(--border,#e5e7eb);border-radius:12px;background:var(--bg,#fff);padding:.75rem .9rem;box-shadow:0 1px 2px rgba(0,0,0,.05)}
    .post__meta{display:flex;flex-wrap:wrap;gap:.35rem;align-items:center;font-size:.95rem}
    .post__title{margin:.15rem 0 .35rem}
    .post__body{white-space:pre-wrap;line-height:1.5}
    .post__foot{display:flex;gap:.4rem;align-items:center;justify-content:space-between;margin-top:.6rem;flex-wrap:wrap}
    .post__mod{display:flex;gap:.35rem}
    .btn-chip{border:1px solid var(--border,#e5e7eb);background:transparent;border-radius:999px;padding:.25rem .6rem;cursor:pointer;font-size:.9rem}
    .badge{border:1px solid var(--border,#e5e7eb);border-radius:999px;padding:.05rem .45rem;font-size:.8rem}
    .post__comments{margin-top:.6rem;border-top:1px dashed var(--border,#e5e7eb);padding-top:.6rem}
    .comment-list{list-style:none;padding:0;margin:0;display:grid;gap:.4rem}
    .comment{padding:.35rem .5rem;border-radius:8px;background:var(--bg-light,#f8fafc)}
    body.dark .post{background:#232334;border-color:#3b3b56}
    body.dark .comment{background:#2e2e45}
    .pager{display:flex;gap:.5rem;align-items:center;justify-content:flex-end;flex-wrap:wrap}
    .muted{color:#6b7280}
    body.dark .muted{color:#c9cdd4}
    @media (min-width:860px){.composer .grid-2{display:grid;grid-template-columns:1fr 2fr;gap:.6rem}}
  </style>
</head>
<body class="page page--community" data-required-role="resident,landlord" data-api-base="/api">
  <header class="site-header">
    <nav class="nav" aria-label="Main">
      <div class="nav-inner container">
        <a class="logo" href="index.html">
          <img src="assets/logo.png" alt="" width="26" height="26" />
          <span>Baylis Property LTD</span>
        </a>
        <button class="btn secondary hamb" aria-expanded="false" aria-controls="navLinks" aria-label="Toggle menu" data-hamb>☰</button>
        <div class="nav-links" id="navLinks" data-links data-open="false">
          <a href="index.html">Dashboard</a>
          <a href="resident.html">Resident</a>
          <a href="landlord.html">Landlord</a>
          <a href="community.html" aria-current="page">Community</a>
          <a href="profile.html">Profile</a>
          <a href="settings.html">Settings</a>
          <a href="login.html">Login</a>
          <a href="register.html">Register</a>
        </div>
      </div>
    </nav>
  </header>

  <main id="content" class="container" tabindex="-1">
    <section class="dashboard-card">
      <div class="community-hero">
        <div>
          <h1 class="h1">Community</h1>
          <p class="muted">Share updates, ask questions, and connect with your neighbours.</p>
        </div>
        <div class="hero-actions">
          <button class="btn-chip" type="button" data-accent-option="blue" title="Accent: Blue">Blue</button>
          <button class="btn-chip" type="button" data-accent-option="teal" title="Accent: Teal">Teal</button>
          <button class="btn-chip" type="button" data-accent-option="violet" title="Accent: Violet">Violet</button>
        </div>
      </div>
    </section>

    <section class="dashboard-card" aria-label="Filters">
      <div class="filters-row">
        <input id="postSearch" type="search" placeholder="Search posts by title, message, or author…" aria-label="Search posts" />
        <select id="postSort" title="Sort posts">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
          <option value="most_liked">Most liked</option>
          <option value="pinned_first">Pinned first</option>
        </select>
        <label class="checkbox"><input id="filterMine" type="checkbox" /> <span>Mine only</span></label>
        <label class="checkbox"><input id="filterPinnedOnly" type="checkbox" /> <span>Pinned only</span></label>
        <button id="exportCommunityBtn" class="btn secondary" type="button">Export</button>
        <button class="btn secondary" type="button" onclick="document.getElementById('importCommunityInput').click()">Import</button>
        <input id="importCommunityInput" type="file" accept="application/json" class="sr-only" title="Import community data" />
      </div>
    </section>

    <section class="dashboard-card composer" aria-label="Composer">
      <form id="communityForm" autocomplete="off">
        <div class="grid-2">
          <label class="field">
            <span>Title <small class="muted">(optional)</small></span>
            <input id="postTitle" type="text" placeholder="e.g. Lost parcel? Cleaner recommendation?" maxlength="120" />
          </label>
          <label class="field">
            <span>Message</span>
            <textarea id="postMessage" placeholder="Write your message for the community…" required rows="4"></textarea>
          </label>
        </div>
        <div>
          <button type="reset" class="btn secondary">Clear</button>
          <button type="submit" class="btn">Post</button>
        </div>
      </form>
    </section>

    <section class="dashboard-card" aria-label="Community posts">
      <ul id="communityFeed" class="post-feed">
        <li class="muted">Loading…</li>
      </ul>
      <div class="pager">
        <button id="pagePrev" class="btn secondary" type="button" aria-label="Previous page">Prev</button>
        <span id="pageInfo" class="muted" aria-live="polite">Page 1 / 1 · 0 posts</span>
        <button id="pageNext" class="btn secondary" type="button" aria-label="Next page">Next</button>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>&copy; <span id="year"></span> Baylis Property LTD</small>
      <span class="dot">&middot;</span>
      <a href="community.html" aria-current="page">Community</a>
      <span class="dot">&middot;</span>
      <a href="settings.html">Settings</a>
    </div>
  </footer>

  <noscript>
    <div class="container" style="margin-top:1rem;">
      <div class="dashboard-card">
        <strong>JavaScript required</strong>
        <p class="muted">This page needs JavaScript enabled for posting, comments, and filtering.</p>
      </div>
    </div>
  </noscript>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const hamb = document.querySelector('[data-hamb]');
    const links = document.querySelector('[data-links]');
    if (hamb && links) {
      const setOpen = (open) => {
        hamb.setAttribute('aria-expanded', String(open));
        links.dataset.open = String(open);
        document.body.classList.toggle('nav-open', open);
      };
      hamb.addEventListener('click', () => setOpen(links.dataset.open !== 'true'));
      links.addEventListener('click', e => { if (e.target.closest('a')) setOpen(false); });
      document.addEventListener('keydown', e => { if (e.key === 'Escape') setOpen(false); });
      document.addEventListener('click', e => { if (!links.contains(e.target) && !hamb.contains(e.target)) setOpen(false); });
    }
  </script>
</body>
</html>
